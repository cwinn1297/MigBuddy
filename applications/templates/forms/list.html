{% load static %}
<!DOCTYPE html>
<html>
<head>
    <title>USCIS Forms - Fillable Check</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 2rem; background: #f5f7fa; }
        h1 { color: #1a3c6e; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; background: white; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #ddd; }
        th { background: #0066cc; color: white; }
        .fillable { color: green; font-weight: bold; }
        .not-fillable { color: red; font-weight: bold; }
        .btn { padding: 10px 16px; background: #0066cc; color: white; text-decoration: none; border-radius: 5px; }
        .btn:hover { background: #0052a3; }
        .warning { background: #fff3cd; padding: 15px; border-radius: 8px; margin: 20px 0; }
    </style>
</head>
<body>
    <h1>USCIS Forms in static/forms/</h1>

    {% if not pdf_files %}
        <p>No PDFs found in <code>applications/static/forms/</code></p>
    {% else %}
        <table>
            <tr>
                <th>Form Name</th>
                <th>Size</th>
                <th>Fillable?</th>
                <th>Fields Count</th>
                <th>Sample Field Names</th>
                <th>Action</th>
            </tr>
            {% for f in pdf_files %}
            <tr>
                <td><strong>{{ f.name }}</strong></td>
                <td>{{ f.size_mb }} MB</td>
                <td>
                    {% if f.is_fillable %}
                        <span class="fillable">YES</span>
                    {% else %}
                        <span class="not-fillable">NO</span>
                    {% endif %}
                </td>
                <td>{{ f.num_fields }}</td>
                <td>
                    {% if f.field_sample %}
                        <small>{{ f.field_sample|join:", " }}{% if f.num_fields > 5 %}...{% endif %}</small>
                    {% else %}
                        <em>none</em>
                    {% endif %}
                </td>
                <td>
                    {% if f.is_fillable %}
                    <a href="{% url 'forms:open_form' f.name %}" class="btn">Open Form →</a>
                    {% else %}
                    <a href="{% url 'forms:open_form' f.name %}?view_pdf=true" target="_blank" class="btn">View PDF →</a>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </table>

        <div class="warning">
            <strong>Important:</strong> Only PDFs with <span class="fillable">YES</span> and >0 fields can be auto-filled with Python.<br>
            Your current i-129f.pdf is likely the <strong>non-fillable</strong> version (printed/scanned).<br><br>
            <strong>Fix it now:</strong><br>
            <code>
            curl -L -o applications/static/forms/i-129f.pdf https://www.uscis.gov/sites/default/files/document/forms/i-129f.pdf
            </code>
        </div>
    {% endif %}
</body>
</html>